# Feature Specification: TimeTrackerPage モバイル最適化

**Feature Branch**: `[002-sp-web-markup]`  
**Created**: 2025-10-13  
**Status**: Draft  
**Input**: User description: "app/src/features/time-tracker/pages/TimeTracker/TimeTrackerPage.tsx をスマホからも使いやすくしたいです。"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - モバイルでタイマーを開始・停止できる (Priority: P1)

スマートフォンから作業を開始するユーザーが、ページを開いてすぐにタイマーの開始と停止を直感的に操作できる。

**Why this priority**: タイムトラッキングの最重要行為であり、開始・停止ができなければ他の機能が意味をなさないため。

**Independent Test**: スマホ実機でページを開き、スクロールせずにタイマーの開始→停止を完了できることを確認するテストで独立検証可能。

**Acceptance Scenarios**:

1. **Given** スマートフォンの縦画面でタイマーが停止状態で表示されている, **When** ユーザーが開始ボタンを1回タップする, **Then** 新しいセッションが開始され経過時間が視認可能になる。
2. **Given** スマートフォンの縦画面でタイマーが稼働中である, **When** ユーザーが停止ボタンをタップする, **Then** セッションが停止して保存され、次の入力欄が表示されたままになる。

---

### User Story 2 - モバイルでグローバルメニューにアクセスできる (Priority: P2)

スマートフォンで TimeTrackerPage を開いたユーザーが、既存の左メニューに含まれる機能へ迷わず遷移できる。

**Why this priority**: 業務継続に必要な他機能への導線が失われると利用価値が大幅に低下するため、タイマー操作に次いで重要。

**Independent Test**: モバイル画面でハンバーガーアイコンを開閉し、メニュー項目を選択できるかを単体で検証可能。

**Acceptance Scenarios**:

1. **Given** スマホ表示で TimeTrackerPage を開いている, **When** 左上のハンバーガーアイコンを1回タップする, **Then** 左メニューと同等の項目が全画面またはシート表示で展開され、スクロールのみで全項目にアクセスできる。
2. **Given** ハンバーガーメニューが展開されている, **When** ユーザーが任意のメニュー項目をタップするか閉じる操作を実行する, **Then** メニューが閉じて背面コンテンツが再度操作可能になり、選択した導線が発火する。

---

### User Story 3 - 進行中セッションをスマホで調整できる (Priority: P3)

外出先でスマホを使うユーザーが、進行中セッションのタイトルやプロジェクトを確認・調整しながら経過時間を把握できる。

**Why this priority**: セッション内容の調整ができないと記録の精度が落ち、日報や請求に影響するため。

**Independent Test**: 進行中セッションの情報確認と編集をスマホで行い、編集結果が保存されるかを単独テストで検証できる。

**Acceptance Scenarios**:

1. **Given** 進行中セッションが存在しスマホで表示している, **When** ユーザーが編集アクションを開く, **Then** タイトルとプロジェクトを全画面フォームで修正し保存できる。
2. **Given** 進行中セッションが1つだけ存在する, **When** ユーザーが経過時間表示を確認する, **Then** 文字が縮小せず読みやすいサイズで表示される。

---

### User Story 4 - 履歴をスマホで確認・編集できる (Priority: P4)

スマホで移動中のユーザーが、過去のセッション履歴をスクロールで確認し、必要に応じて詳細を編集または削除できる。

**Why this priority**: 作業後すぐに修正したい場合があり、モバイルから履歴編集ができないと後続業務に支障が出るため。

**Independent Test**: スマホで履歴一覧から任意のセッションを開き、編集・削除・取り消しができることを単独テストで検証できる。

**Acceptance Scenarios**:

1. **Given** スマホで履歴一覧を閲覧している, **When** ユーザーが任意の履歴項目をタップする, **Then** 全画面モーダルが開き詳細情報を編集・保存できる。
2. **Given** ユーザーが履歴項目を削除した直後, **When** 元に戻す操作を実行する, **Then** 削除前の状態が表示リストに復元される。

---

### Edge Cases

- ビューポート幅が320px程度の小型端末でも横スクロールが発生しないか。
- 端末の向きを縦横で切り替えた際にレイアウトが崩れず主要機能が利用できるか。
- ネットワークが不安定な状態で同期バナーやエラーメッセージが重なって操作が阻害されないか。
- 長時間実行して経過時間が5桁を超えた場合でもタイマー表示が折り返さないか。
- 履歴項目数が多い場合でも無限スクロールや読み込み中表示が操作の邪魔にならないか。
- メニュー展開中に背面コンテンツがスクロール・タップできてしまい誤操作が発生しないか。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: ビューポート幅が 320〜480px の端末では主要コンポーネントが単一カラムに再配置され、横スクロールが発生してはならない。
- **FR-002**: タイマー開始/停止の主要操作はページ読み込み直後のファーストビュー内に表示され、縦スクロール無しでタップできなければならない。
- **FR-003**: スマホ表示時の主要タップ領域（開始/停止ボタン、履歴アイテム、保存ボタンなど）は高さ・幅ともにタッチ領域 44px 以上を確保しなければならない。
- **FR-004**: 稼働中タイマーの経過時間テキストはスマホ縦画面でフォントサイズ 18pt 相当以上を維持し、他要素との重なりが発生してはならない。
- **FR-005**: 進行中セッションの詳細編集はスマホ幅で全画面またはシート型の編集ビューとして表示され、スクロール操作のみで全項目にアクセスできなければならない。
- **FR-006**: 履歴一覧はスマホ幅で1カラム表示になり、各項目のタップで詳細ビューへ遷移でき、戻る操作で一覧へ復帰できなければならない。
- **FR-007**: Google スプレッドシート同期の状態表示と設定導線はスマホでも視認でき、設定ダイアログはモーダル全画面表示で主要項目へアクセスできなければならない。
- **FR-008**: スマホで警告・エラーバナーが表示される場合でも、タイマー開始/停止操作を覆い隠さず、閉じる・再試行操作がタップ可能でなければならない。
- **FR-009**: スマホ表示時に安全領域（ノッチやホームインジケーター）を考慮し、重要コンポーネントが画面外に切れないように余白を確保しなければならない。
- **FR-010**: 既存の左サイドメニューはスマホ表示時にハンバーガーアイコンで開閉でき、展開中は背面コンテンツのスクロール・タップが無効化され、閉じる操作が常に届かなければならない。

### Key Entities *(include if feature involves data)*

- **TimeTrackerSession**: ユーザーが記録した作業単位。属性はタイトル、プロジェクト、開始日時、終了日時、所要時間、同期状態を含む。履歴一覧や詳細編集ビューで表示・更新される。
- **RunningSessionState**: 現在進行中のセッション状態。属性はドラフト（タイトル、プロジェクト、開始時刻）、経過時間、ステータスを持ち、タイマー表示および編集ビューで参照される。
- **SyncStatus**: Google スプレッドシート同期の進行状況を表す。属性は同期ステータス、最終同期時間、エラーメッセージなどで、バナー表示や設定ダイアログに利用される。

## Assumptions

- 対象とするスマートフォンは iOS/Android の最新2世代程度で、画面幅 320〜480px を想定する。
- 既存のデータモデルや認証フローは変更しない。
- Google スプレッドシート連携やバックエンド API の挙動は現行仕様のままとし、UI での露出方法のみを調整する。
- デスクトップレイアウトは現状維持とし、レスポンシブ対応によりモバイル表示を追加する。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: モバイル実機でのユーザビリティテストにて、テスターの 95% 以上が 30 秒以内にタイマーの開始と停止を 2 連続で完了できる。
- **SC-002**: ビューポート幅 320px・高さ 640px の検証で横スクロールが 0 回であることを QA が確認する。
- **SC-003**: 進行中セッションのタイトル/プロジェクト編集フローについて、モバイルユーザーアンケートで「読みやすい」「操作しやすい」と回答する割合が 90% 以上となる。
- **SC-004**: モバイル経由のヘルプデスク問い合わせ件数において、「操作できない」「ボタンが押しづらい」カテゴリがリリース後 1 ヶ月で 50% 以上減少する。
